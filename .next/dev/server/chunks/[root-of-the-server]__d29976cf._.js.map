{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Downloads/aicareermentor/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\nimport { cookies } from \"next/headers\"\n\n/**\n * Especially important if using Fluid compute: Don't put this client in a\n * global variable. Always create a new client within each function when using\n * it.\n */\nexport async function createClient() {\n  const cookieStore = await cookies()\n\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // The \"setAll\" method was called from a Server Component.\n          // This can be ignored if you have middleware refreshing\n          // user sessions.\n        }\n      },\n    },\n  })\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAOO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,2KAAO;IAEjC,OAAO,IAAA,gOAAkB,sUAAoF;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Downloads/aicareermentor/app/api/career-path/route.ts"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\"\nimport { NextResponse } from \"next/server\"\n\nexport const runtime = \"nodejs\"\n\n// Helper function to call Ollama API (open-source AI)\nasync function callOllama(prompt: string): Promise<string> {\n  const ollamaUrl = process.env.OLLAMA_URL || \"http://localhost:11434\"\n  const model = process.env.OLLAMA_MODEL || \"llama3.2\"\n\n  try {\n    const response = await fetch(`${ollamaUrl}/api/generate`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        model: model,\n        prompt: prompt,\n        stream: false,\n        options: {\n          temperature: 0.7,\n          num_predict: 3000,\n        },\n      }),\n    })\n\n    if (!response.ok) {\n      throw new Error(`Ollama API error: ${response.statusText}`)\n    }\n\n    const data = await response.json()\n    return data.response || \"\"\n  } catch (error) {\n    console.error(\"[v0] Ollama API error:\", error)\n    throw error\n  }\n}\n\n// Generate career path with AI\nasync function generateCareerPathWithAI(quizAnswers: any): Promise<any> {\n  const quizQuestions = [\n    \"What type of work environment do you prefer?\",\n    \"Which skill area interests you most?\",\n    \"What is your primary career goal?\",\n    \"How do you prefer to learn?\",\n    \"What level of responsibility do you want?\",\n  ]\n\n  const formattedAnswers = Object.entries(quizAnswers)\n    .map(([key, value]) => {\n      const questionIndex = Number.parseInt(key)\n      const question = quizQuestions[questionIndex] || `Question ${questionIndex + 1}`\n      return `${question}\\nAnswer: ${value}`\n    })\n    .join(\"\\n\\n\")\n\n  const prompt = `Based on these quiz answers, generate a detailed 4-phase career path in JSON format.\n\nQuiz Answers:\n${formattedAnswers}\n\nGenerate a career path with exactly 4 phases. Each phase must have:\n- title: Phase name (e.g., \"Foundation\", \"Core Skills\", \"Advanced\", \"Professional\")\n- phase: Same as title\n- duration: Time estimate (e.g., \"3-6 months\", \"6-12 months\")\n- skills: Array of 5-7 specific skills to learn\n- resources: Array of 5-7 learning resources (websites, courses, platforms)\n- actionable_steps: Array of 3-5 specific action steps\n\nReturn ONLY valid JSON in this exact format:\n{\n  \"phase_1\": {\n    \"title\": \"Foundation\",\n    \"phase\": \"Foundation\",\n    \"duration\": \"3-6 months\",\n    \"skills\": [\"skill1\", \"skill2\", \"skill3\"],\n    \"resources\": [\"resource1\", \"resource2\", \"resource3\"],\n    \"actionable_steps\": [\"step1\", \"step2\", \"step3\"]\n  },\n  \"phase_2\": { ... },\n  \"phase_3\": { ... },\n  \"phase_4\": { ... }\n}\n\nMake it specific, practical, and tailored to the user's answers. Focus on IT/Engineering careers in Tunisia and Europe.`\n\n  const aiResponse = await callOllama(prompt)\n  let cleanedResponse = aiResponse.trim()\n\n  // Extract JSON from response\n  try {\n    const jsonMatch = cleanedResponse.match(/```(?:json)?\\s*(\\{[\\s\\S]*\\})\\s*```/) || cleanedResponse.match(/(\\{[\\s\\S]*\\})/)\n    if (jsonMatch) {\n      cleanedResponse = jsonMatch[1]\n    }\n    const parsed = JSON.parse(cleanedResponse)\n    \n    // Ensure we have all 4 phases\n    if (!parsed.phase_1 || !parsed.phase_2 || !parsed.phase_3 || !parsed.phase_4) {\n      throw new Error(\"Invalid career path structure\")\n    }\n    \n    return parsed\n  } catch (error) {\n    console.error(\"[v0] Error parsing AI response:\", error)\n    // Return default structure if parsing fails\n    return {\n      phase_1: {\n        title: \"Foundation\",\n        phase: \"Foundation\",\n        duration: \"3-6 months\",\n        skills: [\"Basic Programming\", \"Version Control\", \"Problem Solving\"],\n        resources: [\"FreeCodeCamp\", \"MDN Web Docs\", \"GitHub\"],\n        actionable_steps: [\"Learn fundamentals\", \"Build first project\", \"Join community\"]\n      },\n      phase_2: {\n        title: \"Core Skills\",\n        phase: \"Core Skills\",\n        duration: \"6-12 months\",\n        skills: [\"Framework Mastery\", \"Database Design\", \"API Development\"],\n        resources: [\"Official Documentation\", \"Online Courses\", \"Practice Projects\"],\n        actionable_steps: [\"Master a framework\", \"Build full-stack app\", \"Contribute to open source\"]\n      },\n      phase_3: {\n        title: \"Advanced\",\n        phase: \"Advanced\",\n        duration: \"12-18 months\",\n        skills: [\"System Design\", \"Cloud Services\", \"DevOps\"],\n        resources: [\"AWS/Azure Certifications\", \"System Design Courses\", \"Industry Best Practices\"],\n        actionable_steps: [\"Design scalable systems\", \"Deploy to cloud\", \"Optimize performance\"]\n      },\n      phase_4: {\n        title: \"Professional\",\n        phase: \"Professional\",\n        duration: \"Ongoing\",\n        skills: [\"Leadership\", \"Architecture\", \"Mentorship\"],\n        resources: [\"Industry Conferences\", \"Advanced Certifications\", \"Continuous Learning\"],\n        actionable_steps: [\"Lead projects\", \"Mentor others\", \"Stay updated with trends\"]\n      }\n    }\n  }\n}\n\nexport async function GET() {\n  try {\n    const supabase = await createClient()\n\n    // Get authenticated user\n    const {\n      data: { user },\n      error: userError,\n    } = await supabase.auth.getUser()\n\n    if (userError || !user) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n    }\n\n    // Fetch user's latest career path\n    let { data, error } = await supabase\n      .from(\"career_paths\")\n      .select(\"*\")\n      .eq(\"user_id\", user.id)\n      .order(\"created_at\", { ascending: false })\n      .limit(1)\n\n    if (error) throw error\n\n    // If no career path exists, generate one with AI using quiz answers\n    if (!data || data.length === 0) {\n      // Get user's latest quiz answers\n      const { data: quizData, error: quizError } = await supabase\n        .from(\"quiz_results\")\n        .select(\"quiz_answers\")\n        .eq(\"user_id\", user.id)\n        .order(\"created_at\", { ascending: false })\n        .limit(1)\n\n      if (quizError || !quizData || quizData.length === 0) {\n        return NextResponse.json({ error: \"No career path found. Please complete the quiz first.\" }, { status: 404 })\n      }\n\n      // Generate career path with AI\n      const generatedPath = await generateCareerPathWithAI(quizData[0].quiz_answers)\n\n      // Save generated career path\n      const { data: savedPath, error: saveError } = await supabase\n        .from(\"career_paths\")\n        .insert({\n          user_id: user.id,\n          phase_1: generatedPath.phase_1,\n          phase_2: generatedPath.phase_2,\n          phase_3: generatedPath.phase_3,\n          phase_4: generatedPath.phase_4,\n        })\n        .select()\n        .single()\n\n      if (saveError) {\n        console.error(\"[v0] Error saving career path:\", saveError)\n        // Return the generated path even if save fails\n        return NextResponse.json({\n          phase_1: generatedPath.phase_1,\n          phase_2: generatedPath.phase_2,\n          phase_3: generatedPath.phase_3,\n          phase_4: generatedPath.phase_4,\n        })\n      }\n\n      return NextResponse.json(savedPath)\n    }\n\n    return NextResponse.json(data[0])\n  } catch (error) {\n    console.error(\"[v0] Error fetching career path:\", error)\n    return NextResponse.json({ error: \"Failed to fetch career path\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}